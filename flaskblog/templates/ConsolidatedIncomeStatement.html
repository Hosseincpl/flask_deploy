{% extends "layout.html" %}
{% block content %}
<!DOCTYPE html>
<html lang="fa-ir" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Data Table with Sticky Header</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: lightgray;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        tr:nth-child(odd) {
            background-color: #ffffff;
        }

        .title {
            font-weight: bold;
            background-color: lightblue;
        }
        table {

    width: 80%; /* Adjust the width of the table as needed */
    margin: 0 auto; /* Center the table horizontally */
    border-collapse: collapse;
}

th, td {
    padding: 8px;
    text-align: center;
    border: 1px solid #dddddd;
}

.title {
    background-color: #f2f2f2; /* Gray background for title rows */
}

/* Apply alternate row colors for better readability */
tbody tr:nth-child(even) {
    background-color: #f9f9f9;
}

tbody tr:hover {
    background-color: #f2f2f2; /* Light gray background color on hover */
}

/* Style the editable cells */
td[contenteditable="true"] {
    background-color: #ffffff; /* White background color */
    outline: none; /* Remove outline when editing */
    cursor: text; /* Change cursor to text when editing */
}

/* Apply some padding to the editable cells for better spacing */
td[contenteditable="true"] {
    padding: 6px;
}

/* Apply special styles to the first column */
td:first-child {
    font-weight: bold;
    background-color: #f2f2f2; /* Gray background color */
}
table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 8px;
    text-align: center;
    border: 1px solid #dddddd;
}

.title {
    background-color: #f2f2f2; /* Gray background for title rows */
}

tbody tr:nth-child(even) {
    background-color: #f9f9f9; /* Alternate row background color for better readability */
}

thead tr {
    position: sticky; /* Make the first row sticky */
    top: 100px; /* Stick it to the top */
    background-color: white; /* Background color of the sticky row */
    z-index: 1; /* Ensure it stays on top of other content */
}

    </style>
</head>
<br>
<body>
    <h2 style="text-align: center;" class="text-dark mt-3">صورت وضعیت مالی تلفیقی</h2>
    <br><br>
    <table>
        <thead>
            <tr>
                <th>شرح</th>
                <th>۱۳۹۷</th>
                <th>۱۳۹۸</th>
                <th>۱۳۹۹</th>
                <th>۱۴۰۰</th>
                <th>۱۴۰۱</th>
                <th>۱۴۰۲</th>
            </tr>
        </thead>
        <tbody>
            <tr class="title">
                <td colspan="8">دارايي‌ها</td>
                
            </tr>
            <tr class="title">
                
                <td colspan="8">دارايي‌هاي غيرجاري</td>
            </tr>
            <tr>
                <td> دارايي‌هاي ثابت مشهود</td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>سرمايه‌گذاري در املاک</td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>سرقفلي</td>
                <td id="sum-row-3"></td>
                <td id="sum-row-3"></td>
                <td id="sum-row-3"></td>
                <td id="sum-row-3"></td>
                <td id="sum-row-3"></td>
                <td id="sum-row-3"></td>
            </tr>
            <tr>
                <td>دارايي‌هاي نامشهود</td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>سرمايه گذاري در شرکتهاي وابسته</td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>ساير سرمايه‌گذاري‌هاي بلندمدت </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>دريافتني‌هاي بلندمدت


                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>دارايي ماليات انتقالي


                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>ساير دارايي‌ها


                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع دارايي‌هاي غيرجاري


                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr class="title">
                <td colspan="8">دارايي‌هاي جاري
                </td>
            </tr>
            <tr>
                <td>سفارشات و پيش‌پرداخت‌ها


                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <!-- Repeat the above row for 9 more rows -->
            <tr>
                <td>موجودي مواد و کالا

                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>دريافتني‌هاي تجاري و ساير دريافتني‌ها

                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>


            <!-- Repeat the above row for 9 more rows -->
            <!-- <tr class="title">
                <td colspan="8">سود(زيان) پايه هر سهم:
                </td>
            </tr> -->
            <tr>
                <td>سرمايه‌گذاري‌هاي کوتاه‌مدت

                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>موجودي نقد

                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>دارايي‌هاي نگهداري شده براي فروش

                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع دارايي‌هاي جاري

                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع دارايي‌ها

                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>

            <tr class="title">
                <td colspan="8">حقوق مالکانه و بدهي‌ها
                    :
                </td>
            </tr>
            <tr class="title">
                <td colspan="8">حقوق مالکانه
                    :
                </td>
            </tr>


            <td>سرمايه

            </td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>افزايش سرمايه در جريان
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>صرف سهام
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>صرف سهام خزانه
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>آثار معاملات سهام خزانه شرکت فرعي
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>آثار معاملات با منافع فاقد حق کنترل
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>اندوخته قانوني
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>ساير اندوخته‌ها
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>مازاد تجديدارزيابي دارايي‌ها
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>تفاوت تسعير ارز عمليات خارجي
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>سود انباشته
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>سهام خزانه (شامل سهام شرکت در مالکيت شرکت‌هاي فرعي)
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>حقوق مالکانه قابل انتساب به مالکان شرکت اصلي
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>منافع فاقد کنترل
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع حقوق مالکانه
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr class="title">
                <td colspan="8">
                    بدهي‌ها

                </td>
            </tr>
            <tr class="title">
                <td colspan="8">بدهي‌هاي غيرجاري


                </td>
            </tr>
            <tr>
                <td>پرداختني‌هاي بلندمدت
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>تسهيلات مالي بلندمدت
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>بدهي ماليات انتقالي
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>ذخيره مزاياي پايان خدمت کارکنان
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع بدهي‌هاي غيرجاري
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr class="title">
                <td colspan="8">بدهي‌هاي جاري



                </td>
            </tr>
            <tr>
                <td>پرداختني‌هاي تجاري و ساير پرداختني‌ها
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>ماليات پرداختني
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>سود سهام پرداختني
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>تسهيلات مالي
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>ذخاير</td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>پيش‌دريافت‌ها</td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>بدهي‌هاي ‌مرتبط ‌با دارايي‌هاي نگهداري‌‌شده براي ‌فروش
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع بدهي‌هاي جاري
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع بدهي‌ها
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>
            <tr>
                <td>جمع حقوق مالکانه و بدهي‌ها
                </td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
                <td contenteditable="true"></td>
            </tr>





        </tbody>
    </table>
    <p class="text-right text-dark h-5 mt-3">لطفا اسناد و مدارک موجود را در قسمت زیر آپلود کنید.</p>
    <button id="backToTopBtn" onclick="scrollToTop()">بالای صفحه</button> 
    <div class="custom-file mt-3 mb-3">
        <input type="file" class="custom-file-input" id="myFile">
        <label class="custom-file-label" for="myFile">انتخاب فایل</label>
    </div>
<!-- Button trigger modal -->
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary mt-2 mb-3" data-toggle="modal" data-target="#confirmationModal">
    ارسال فرم
</button>

<!-- Modal -->
<div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-right">
        آیا از ارسال فرم مطمئن هستید؟
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary ml-2" data-dismiss="modal">ویرایش</button>
        <button type="button" class="btn btn-primary" id="confirmFormBtn">تأیید</button>
      </div>
    </div>
  </div>
</div>

<script>
    document.getElementById('confirmFormBtn').addEventListener('click', function() {
        // Close the modal when the "تأیید" (Confirm) button is clicked
        $('#confirmationModal').modal('hide');
    });
        function scrollToTop() {
               // document.body.scrollTop = 0; // For Safari
                document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE, and Opera
            }

            // Show the button when scrolling down
            window.onscroll = function () { scrollFunction() };

            function scrollFunction() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    document.getElementById("backToTopBtn").style.display = "block";
                } else {
                    document.getElementById("backToTopBtn").style.display = "none";
                }
            }
        document.querySelectorAll('td[contenteditable="true"]').forEach(function (cell) {
            cell.addEventListener('input', function () {
                if (!/^-?\d*\.?\d*$/.test(this.innerText)) {
                    this.innerText = this.innerText.replace(/[^\d.-]/g, '');
                }
                calculateSum();
            });
        });
        function calculateSum() {
            for (let i = 1; i <= 6; i++) {
                let sum = 0;
                let cells = document.querySelectorAll(`td:nth-child(${i + 1})[contenteditable="true"]`);
                cells.forEach(function (cell) {
                    sum += parseFloat(cell.innerText) || 0;
                });
                document.getElementById(`sum-row-${i + 2}`).innerText = sum;
            }
        }
        document.getElementById('addRowBtn').addEventListener('click', function () {
            var newRow = '<tr><td>New Row, Cell 1</td>';
            for (let i = 0; i < 6; i++) {
                newRow += '<td contenteditable="true"></td>';
            }
            newRow += '</tr>';
            document.querySelector('tbody').insertAdjacentHTML('beforeend', newRow);
        });
        document.getElementById('saveDataBtn').addEventListener('click', function () {
            const tableData = [];
            document.querySelectorAll('td[contenteditable="true"]').forEach(function (cell) {
                tableData.push(cell.innerText);
            });
            fetch('/save_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ data: tableData })
            })
                .then(response => {
                    if (response.ok) {
                        alert('Data saved successfully!');
                    } else {
                        alert('Failed to save data.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        });
    </script>
</body>

</html>
{% endblock content %}